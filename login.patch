21d20
<   CircularProgress,
42a42,43
> import ForgotPasswordForm from "./ForgotPasswordForm"
> 
44,49c45,47
< // const MINIORANGE_AUTH_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/idp/openidsso"
< // const MINIORANGE_TOKEN_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/rest/oauth/token" 
< // const MINIORANGE_USERINFO_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/rest/oauth/getuserinfo"
< const MINIORANGE_AUTH_ENDPOINT = "https://mindlampihub.xecurify.com/moas/idp/openidsso"
< const MINIORANGE_TOKEN_ENDPOINT = "https://mindlampihub.xecurify.com/moas/rest/oauth/token"
< const MINIORANGE_USERINFO_ENDPOINT = "https://mindlampihub.xecurify.com/moas/rest/oauth/getuserinfo"
---
> const MINIORANGE_AUTH_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/idp/openidsso"
> const MINIORANGE_TOKEN_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/rest/oauth/token"
> const MINIORANGE_USERINFO_ENDPOINT = "https://mindlampihub.xecurify.com/moas/login/rest/oauth/getuserinfo"
52,54c50
< // const MINIORANGE_REDIRECT_URI = "http://localhost:3000/oauth/callback"
< const MINIORANGE_REDIRECT_URI = `${window.location.origin}/auth/callback` // Make sure this matches your MiniOrange app configuration
< 
---
> const MINIORANGE_REDIRECT_URI = "http://localhost:3000/oauth/callback"
173a170,171
>   const [showForgotPassword, setShowForgotPassword] = useState(false)
> 
283,287d280
<   const generateState = () => {
<     const array = new Uint32Array(1)
<     window.crypto.getRandomValues(array)
<     return array[0].toString(36)
<   }
289,321c282,286
<     try {
<       setMiniOrangeLoading(true);
<       
<       // Generate and store state
<       const oauthState = generateState();
<       sessionStorage.setItem('miniOrangeState', oauthState);
<       sessionStorage.setItem('miniOrangeServerAddress', state.serverAddress);
<       
<       // Build authorization URL parameters
<       const params = new URLSearchParams({
<         response_type: 'code',
<         client_id: MINIORANGE_CLIENT_ID,
<         redirect_uri: MINIORANGE_REDIRECT_URI,
<         // 'http://localhost:8080/auth/callback',
<         scope: 'openid email profile',
<         state: oauthState,
<         prompt: 'login'                 // Force authentication
<       });  
<   
<       const authUrl = `${MINIORANGE_AUTH_ENDPOINT}?${params.toString()}`;
<       console.log('Redirecting to:', authUrl);
<   
<       window.location.href = authUrl;
<       
<     } catch (error) {
<       console.error("MiniOrange auth error:", error);
<       enqueueSnackbar(`${t("Error during MiniOrange authentication.")}`, {
<         variant: "error",
<       });
<     } finally {
<       setMiniOrangeLoading(false);
<     }
<   };
---
>     setMiniOrangeLoading(true)
>     const authUrl = `${MINIORANGE_AUTH_ENDPOINT}?client_id=${MINIORANGE_CLIENT_ID}&redirect_uri=${MINIORANGE_REDIRECT_URI}&response_type=code&scope=openid email profile`
>     console.log("authUrl", authUrl)
>     window.location.href = authUrl
>   }
323,422c288,307
<     const handleCallback = async () => {
<       // Only run this if we're on the callback route
<       if (!window.location.pathname.includes('/auth/callback')) return;
<   
<       const urlParams = new URLSearchParams(window.location.search);
<       const code = urlParams.get('code');
<       const receivedState = urlParams.get('state');
<       const storedState = sessionStorage.getItem('miniOrangeState');
<   
<       console.log('Callback received:', {
<         hasCode: !!code,
<         state: receivedState,
<         storedState,
<         stateMatch: receivedState === storedState
< 
<       });
<   
<       if (!code) {
<         console.error('No code received in callback');
<         enqueueSnackbar(`${t("Authentication failed - no code received")}`, {
<           variant: "error",
<         });
<         return;
<       }
<   
<       if (receivedState !== storedState) {
<         console.error('State mismatch - possible CSRF attempt');
<         enqueueSnackbar(`${t("Authentication failed - state mismatch")}`, {
<           variant: "error",
<         });
<         return;
<       }
<   
<       try {
<         setLoginClick(true);
<   
<         const tokenResponse = await fetch(MINIORANGE_TOKEN_ENDPOINT, {
<           method: 'POST',
<           headers: {
<             'Content-Type': 'application/x-www-form-urlencoded',
<           },
<           body: new URLSearchParams({
<             grant_type: 'authorization_code',
<             code,
<             client_id: MINIORANGE_CLIENT_ID,
<             client_secret: MINIORANGE_CLIENT_SECRET,
<             redirect_uri: MINIORANGE_REDIRECT_URI,
<             //  'http://localhost:8080/auth/callback',
<           }),
<         });
<   
<         if (!tokenResponse.ok) {
<           const errorText = await tokenResponse.text();
<           console.error('Token Error:', errorText);
<           throw new Error('Token exchange failed');
<         }
<         
<   
<         const tokenData = await tokenResponse.json();
<         
<         const userInfoResponse = await fetch(MINIORANGE_USERINFO_ENDPOINT, {
<           headers: {
<             'Authorization': `Bearer ${tokenData.access_token}`
<           }
<         });
<   
<         if (!userInfoResponse.ok) {
<           throw new Error('Failed to get user info');
<         }
<   
<         const userData = await userInfoResponse.json();
< 
<         // Create user object for setIdentity
<         const miniOrangeUser = {
<           id: `_miniorange_${userData.email || userData.sub}`,
<           password: tokenData.access_token,
<           serverAddress: sessionStorage.getItem('miniOrangeServerAddress') || state.serverAddress
<           };
<   
<         const res = await setIdentity(miniOrangeUser);
<         
<         // Clean up
<         sessionStorage.removeItem('miniOrangeState');
<         sessionStorage.removeItem('miniOrangeServerAddress');
<         
<         onComplete();
<   
<       } catch (error) {
<         console.error('Callback handling error:', error);
<         enqueueSnackbar(`${t("Failed to complete authentication.")}`, {
<           variant: "error",
<         });
<       } finally {
<         setLoginClick(false);
<         setMiniOrangeLoading(false);
<       }
<     };
<   
<     handleCallback();
<   }, []);
---
>     const handleMiniOrangeCallback = async () => {
>       const urlParams = new URLSearchParams(window.location.search)
>       const code = urlParams.get("code")
>       console.log("entry to miniorange")
>       if (code) {
>         try {
>           // Exchange code for token
>           const tokenResponse = await fetch(MINIORANGE_TOKEN_ENDPOINT, {
>             method: "POST",
>             headers: {
>               "Content-Type": "application/x-www-form-urlencoded",
>             },
>             body: new URLSearchParams({
>               grant_type: "authorization_code",
>               code,
>               client_id: MINIORANGE_CLIENT_ID,
>               client_secret: MINIORANGE_CLIENT_SECRET,
>               redirect_uri: MINIORANGE_REDIRECT_URI,
>             }),
>           })
424,548c309
<   const handleMiniOrangeLogin2 = async () => {
<     try {
<       setMiniOrangeLoading(true);
<       
<       // Generate and store state
<       const oauthState = generateState();
<       sessionStorage.setItem('miniOrangeState', oauthState);
<       sessionStorage.setItem('miniOrangeServerAddress', state.serverAddress);
<       
<       // Build authorization URL parameters
<       const params = new URLSearchParams({
<         response_type: 'code',
<         client_id: MINIORANGE_CLIENT_ID,
<         redirect_uri: MINIORANGE_REDIRECT_URI,
<         scope: 'openid email profile',
<         state: oauthState
<       });
<   
<       // Log request parameters for debugging
<       console.log('Auth Request Parameters:', {
<         endpoint: MINIORANGE_AUTH_ENDPOINT,
<         params: Object.fromEntries(params.entries()),
<         fullUrl: `${MINIORANGE_AUTH_ENDPOINT}?${params.toString()}`
<       });
<       try {
<         // Make a test request first to check endpoint
<         const response = await fetch(`${MINIORANGE_AUTH_ENDPOINT}?${params.toString()}`);
<         if (!response.ok) {
<           const errorText = await response.text();
<           console.error('Auth Error:', {
<             status: response.status,
<             statusText: response.statusText,
<             body: errorText
<           });
<           throw new Error(`HTTP error! status: ${response.status}`);
<         }
<         
<         // If test succeeds, proceed with actual redirect
<         window.location.href = `${MINIORANGE_AUTH_ENDPOINT}?${params.toString()}`;
<         
<       } catch (error) {
<         console.error('Network or Auth Error:', error);
<         enqueueSnackbar(`${t("Error connecting to authentication server.")}`, {
<           variant: "error",
<         });
<       }
<     } catch (error) {
<       console.error("MiniOrange auth error:", error);
<       enqueueSnackbar(`${t("Error during MiniOrange authentication.")}`, {
<         variant: "error",
<       });
<     } finally {
<       setMiniOrangeLoading(false);
<     }
<   };
<   
<   // Separate callback handler
<   const handleMiniOrangeCallback = async () => {
<     const urlParams = new URLSearchParams(window.location.search);
<     const code = urlParams.get('code');
<     const receivedState = urlParams.get('state');
<     const storedState = sessionStorage.getItem('miniOrangeState');
<     
<     console.log('Callback Parameters:', {
<       code: code ? 'present' : 'missing',
<       receivedState,
<       storedState,
<       match: receivedState === storedState
<     });
<   
<     if (code && receivedState === storedState) {
<       try {
<         setLoginClick(true);
<         
<         // Log token request parameters
<         console.log('Token Request Parameters:', {
<           endpoint: MINIORANGE_TOKEN_ENDPOINT,
<           code,
<           redirect_uri: MINIORANGE_REDIRECT_URI
<         });
<   
<         const tokenResponse = await fetch(MINIORANGE_TOKEN_ENDPOINT, {
<           method: 'POST',
<           headers: {
<             'Content-Type': 'application/x-www-form-urlencoded',
<           },
<           body: new URLSearchParams({
<             grant_type: 'authorization_code',
<             code,
<             client_id: MINIORANGE_CLIENT_ID,
<             client_secret: MINIORANGE_CLIENT_SECRET,
<             redirect_uri: MINIORANGE_REDIRECT_URI,
<           }),
<         });
<   
<         if (!tokenResponse.ok) {
<           const errorText = await tokenResponse.text();
<           console.error('Token Error:', {
<             status: tokenResponse.status,
<             statusText: tokenResponse.statusText,
<             body: errorText
<           });
<           throw new Error('Token exchange failed');
<         }
<   
<         const data = await tokenResponse.json();
<         console.log('Token Response:', {
<           hasAccessToken: !!data.access_token,
<           tokenType: data.token_type,
<           scope: data.scope
<         });
<   
<         // Continue with your existing login logic...
<         
<       } catch (error) {
<         console.error('Callback handling error:', error);
<         enqueueSnackbar(`${t("Failed to complete authentication.")}`, {
<           variant: "error",
<         });
<       } finally {
<         setLoginClick(false);
<         setMiniOrangeLoading(false);
<       }
<     }
<   };
---
>           const tokenData = await tokenResponse.json()
550,567c311,316
< // try this todo
<   const handleMiniOrangeLogin_1 = async () => {
<     try {
<       setMiniOrangeLoading(true)
<       
<       // First, get authorization token
<       const authResponse = await fetch(MINIORANGE_AUTH_ENDPOINT, {
<         method: 'POST',
<         headers: {
<           'Content-Type': 'application/x-www-form-urlencoded',
<         },
<         body: new URLSearchParams({
<           client_id: MINIORANGE_CLIENT_ID,
<           client_secret: MINIORANGE_CLIENT_SECRET,
<           grant_type: 'client_credentials',
<           scope: 'openid email profile'
<         })
<       });
---
>           // Get user info using access token
>           const userInfoResponse = await fetch(MINIORANGE_USERINFO_ENDPOINT, {
>             headers: {
>               Authorization: `Bearer ${tokenData.access_token}`,
>             },
>           })
569,571c318
<       if (!authResponse.ok) {
<         throw new Error('Failed to get authorization token');
<       }
---
>           const userData = await userInfoResponse.json()
573,580c320,325
<       const authData = await authResponse.json();
<       
<       // Now get user info using the access token
<       const userInfoResponse = await fetch(MINIORANGE_USERINFO_ENDPOINT, {
<         headers: {
<           'Authorization': `Bearer ${authData.access_token}`,
<         }
<       });
---
>           // Format user data similar to Google login
>           const miniOrangeUser = {
>             id: "_miniorange_" + userData.email,
>             password: tokenData.access_token,
>             serverAddress: state.serverAddress || lastDomain,
>           }
582,584c327
<       if (!userInfoResponse.ok) {
<         throw new Error('Failed to get user info');
<       }
---
>           setLoginClick(true)
586c329,330
<       const userData = await userInfoResponse.json();
---
>           try {
>             const res = await setIdentity(miniOrangeUser)
588,593c332,345
<       // Create user object for setIdentity
<       const miniOrangeUser = {
<         id: "_miniorange_" + userData.email,
<         password: authData.access_token,
<         serverAddress: state.serverAddress || lastDomain,
<       }
---
>             if (res.authType === "participant") {
>               localStorage.setItem("lastTab" + res.identity.id, JSON.stringify(new Date().getTime()))
>               await LAMP.SensorEvent.create(res.identity.id, {
>                 timestamp: Date.now(),
>                 sensor: "lamp.analytics",
>                 data: {
>                   type: "login",
>                   device_type: "Dashboard",
>                   user_agent: `LAMP-dashboard/${process.env.REACT_APP_GIT_SHA} ${window.navigator.userAgent}`,
>                   login_method: "miniorange",
>                 },
>               } as any)
>               await LAMP.Type.setAttachment(res.identity.id, "me", "lamp.participant.timezone", timezoneVal())
>             }
595c347,352
<       setLoginClick(true)
---
>             localStorage.setItem(
>               "LAMP_user_" + res.identity.id,
>               JSON.stringify({
>                 language: selectedLanguage,
>               })
>             )
597,613c354,355
<       try {
<         const res = await setIdentity(miniOrangeUser)
<         
<         if (res.authType === "participant") {
<           localStorage.setItem("lastTab" + res.identity.id, JSON.stringify(new Date().getTime()))
<           await LAMP.SensorEvent.create(res.identity.id, {
<             timestamp: Date.now(),
<             sensor: "lamp.analytics",
<             data: {
<               type: "login",
<               device_type: "Dashboard",
<               user_agent: `LAMP-dashboard/${process.env.REACT_APP_GIT_SHA} ${window.navigator.userAgent}`,
<               login_method: "miniorange",
<             },
<           } as any)
<           await LAMP.Type.setAttachment(res.identity.id, "me", "lamp.participant.timezone", timezoneVal())
<         }
---
>             await Service.deleteDB()
>             await Service.deleteUserDB()
615,618c357,367
<         localStorage.setItem(
<           "LAMP_user_" + res.identity.id,
<           JSON.stringify({
<             language: selectedLanguage,
---
>             setLoginClick(false)
>             onComplete()
>           } catch (err) {
>             enqueueSnackbar(`${t("Failed to authenticate with MiniOrange credentials.")}`, {
>               variant: "error",
>             })
>             setLoginClick(false)
>           }
>         } catch (error) {
>           enqueueSnackbar(`${t("Error processing MiniOrange sign-in.")}`, {
>             variant: "error",
620,632c369,370
<         )
< 
<         await Service.deleteDB()
<         await Service.deleteUserDB()
< 
<         setLoginClick(false)
<         onComplete()
<       } catch (err) {
<         console.error("SetIdentity error:", err)
<         enqueueSnackbar(`${t("Failed to authenticate with MiniOrange.")}`, {
<           variant: "error",
<         })
<         setLoginClick(false)
---
>           setLoginClick(false)
>         }
634,640d371
<     } catch (error) {
<       console.error("MiniOrange auth error:", error)
<       enqueueSnackbar(`${t("Error during MiniOrange authentication.")}`, {
<         variant: "error",
<       })
<     } finally {
<       setMiniOrangeLoading(false)
642d372
<   }
644,738c374,375
<   // const handleMiniOrangeLogin = () => {
<   //   setMiniOrangeLoading(true)
<   //   const authUrl = `${MINIORANGE_AUTH_ENDPOINT}?client_id=${MINIORANGE_CLIENT_ID}&redirect_uri=${MINIORANGE_REDIRECT_URI}&response_type=code&scope=openid email profile`
<   //   console.log("authUrl", authUrl)
<   //   window.location.href = authUrl
<   // }
<   // useEffect(() => {
<   //   const handleMiniOrangeCallback = async () => {
<   //     const urlParams = new URLSearchParams(window.location.search)
<   //     const code = urlParams.get("code")
<   //     console.log("entry to miniorange")
<   //     if (code) {
<   //       try {
<   //         // Exchange code for token
<   //         const tokenResponse = await fetch(MINIORANGE_TOKEN_ENDPOINT, {
<   //           method: "POST",
<   //           headers: {
<   //             "Content-Type": "application/x-www-form-urlencoded",
<   //           },
<   //           body: new URLSearchParams({
<   //             grant_type: "authorization_code",
<   //             code,
<   //             client_id: MINIORANGE_CLIENT_ID,
<   //             client_secret: MINIORANGE_CLIENT_SECRET,
<   //             redirect_uri: MINIORANGE_REDIRECT_URI,
<   //           }),
<   //         })
< 
<   //         const tokenData = await tokenResponse.json()
< 
<   //         // Get user info using access token
<   //         const userInfoResponse = await fetch(MINIORANGE_USERINFO_ENDPOINT, {
<   //           headers: {
<   //             Authorization: `Bearer ${tokenData.access_token}`,
<   //           },
<   //         })
< 
<   //         const userData = await userInfoResponse.json()
< 
<   //         // Format user data similar to Google login
<   //         const miniOrangeUser = {
<   //           id: "_miniorange_" + userData.email,
<   //           password: tokenData.access_token,
<   //           serverAddress: state.serverAddress || lastDomain,
<   //         }
< 
<   //         setLoginClick(true)
< 
<   //         try {
<   //           const res = await setIdentity(miniOrangeUser)
< 
<   //           if (res.authType === "participant") {
<   //             localStorage.setItem("lastTab" + res.identity.id, JSON.stringify(new Date().getTime()))
<   //             await LAMP.SensorEvent.create(res.identity.id, {
<   //               timestamp: Date.now(),
<   //               sensor: "lamp.analytics",
<   //               data: {
<   //                 type: "login",
<   //                 device_type: "Dashboard",
<   //                 user_agent: `LAMP-dashboard/${process.env.REACT_APP_GIT_SHA} ${window.navigator.userAgent}`,
<   //                 login_method: "miniorange",
<   //               },
<   //             } as any)
<   //             await LAMP.Type.setAttachment(res.identity.id, "me", "lamp.participant.timezone", timezoneVal())
<   //           }
< 
<   //           localStorage.setItem(
<   //             "LAMP_user_" + res.identity.id,
<   //             JSON.stringify({
<   //               language: selectedLanguage,
<   //             })
<   //           )
< 
<   //           await Service.deleteDB()
<   //           await Service.deleteUserDB()
< 
<   //           setLoginClick(false)
<   //           onComplete()
<   //         } catch (err) {
<   //           enqueueSnackbar(`${t("Failed to authenticate with MiniOrange credentials.")}`, {
<   //             variant: "error",
<   //           })
<   //           setLoginClick(false)
<   //         }
<   //       } catch (error) {
<   //         enqueueSnackbar(`${t("Error processing MiniOrange sign-in.")}`, {
<   //           variant: "error",
<   //         })
<   //         setLoginClick(false)
<   //       }
<   //     }
<   //   }
< 
<   //   handleMiniOrangeCallback()
<   // }, [])
---
>     handleMiniOrangeCallback()
>   }, [])
914,917c551,554
<         ;(async () => {
<           await Service.deleteDB()
<           await Service.deleteUserDB()
<         })()
---
>           ; (async () => {
>             await Service.deleteDB()
>             await Service.deleteUserDB()
>           })()
939,1075c576,597
<         <div style={{ position: "fixed", top: 8, right: 16, display: "flex", alignItems: "center", gap: "8px" }}>
<           <Fab
<             color="primary"
<             aria-label="select language"
<             // onClick={handleOpen}
<             onClick={(event) => setFabMenu(event.currentTarget)} // Open menu on click
<             size="small"
<             // style={{ position: "fixed", top: 16, right: 16 }}
<           >
<             <TranslateIcon />
<           </Fab>
<           <Menu
<             anchorEl={fabMenu} // Position menu relative to Fab
<             open={Boolean(fabMenu)} // Open the menu if fabMenu is set
<             onClose={() => setFabMenu(null)} // Close menu on selection or outside click
<           >
<             {Object.keys(locale_lang).map((key) => {
<               if (userLanguages.includes(key)) {
<                 return (
<                   <MenuItem
<                     key={key}
<                     value={key}
<                     onClick={() => {
<                       setSelectedLanguage(key) // Set language on click
<                       setFabMenu(null) // Close menu
<                     }}
<                   >
<                     {`${locale_lang[key].native} (${locale_lang[key].english})`}
<                   </MenuItem>
<                 )
<               }
<             })}
<           </Menu>
< 
<           {/* Language Selection Menu */}
<           {/* <Select
<         open={open}
<         onClose={handleClose}
<         value={selectedLanguage || "en-US"}
<         onChange={(event) => {
<           setSelectedLanguage(event.target.value)
<           handleClose() // Close dropdown on language select
<         }}
<         variant="filled"
<         style={{ display: "none" }} // Hide the Select visually, handled by FAB
<       >
<         {Object.keys(locale_lang).map((key) => {
<           if (userLanguages.includes(key)) {
<             return (
<               <MenuItem key={key} value={key}>
<                 {locale_lang[key].native + " (" + locale_lang[key].english + ")"}
<               </MenuItem>
<             )
<           }
<         })}
<       </Select> */}
<           <Fab
<             size="small"
<             color="primary"
<             aria-label="help"
<             // style={{ position: "fixed", top: 8, right: 8 }}
<             onClick={(event) => setHelpMenu(event.currentTarget)}
<           >
<             {/* <HelpCenterOutlined/> */}
<             <HelpIcon style={{ fontSize: "2.5 rem" }} />
<             {/* <Icon style={{ fontSize: "2rem", color:"#23c433" }}>help</Icon> */}
<           </Fab>
<           <Menu
<             id="simple-menu"
<             anchorEl={helpMenu}
<             keepMounted
<             open={Boolean(helpMenu)}
<             onClose={() => setHelpMenu(undefined)}
<           >
<             <MenuItem
<               dense
<               onClick={() => {
<                 setHelpMenu(undefined)
<                 window.open("https://docs.lamp.digital", "_blank")
<               }}
<             >
<               <b style={{ color: colors.grey["600"] }}>{`${t("Help & Support")}`}</b>
<             </MenuItem>
<             <MenuItem
<               dense
<               onClick={() => {
<                 setHelpMenu(undefined)
<                 window.open("https://community.lamp.digital", "_blank")
<               }}
<             >
<               <b style={{ color: colors.grey["600"] }}>LAMP {`${t("Community")}`}</b>
<             </MenuItem>
<             <MenuItem
<               dense
<               onClick={() => {
<                 setHelpMenu(undefined)
<                 window.open("mailto:team@digitalpsych.org", "_blank")
<               }}
<             >
<               <b style={{ color: colors.grey["600"] }}>{`${t("Contact Us")}`}</b>
<             </MenuItem>
<             <MenuItem
<               dense
<               onClick={() => {
<                 setHelpMenu(undefined)
<                 window.open("https://docs.lamp.digital/privacy/", "_blank")
<               }}
<             >
<               <b style={{ color: colors.grey["600"] }}>{`${t("Privacy Policy")}`}</b>
<             </MenuItem>
<           </Menu>
<         </div>
<         <Grid container direction="row" justifyContent="center" alignItems="center" className={classes.loginContainer}>
<           <Grid item className={classes.loginInner}>
<             <form onSubmit={(e) => handleLogin(e)}>
<               <Box>
<                 <Box className={classes.logoLogin}>
<                   <Logo />
<                 </Box>
<                 <Box className={classes.logoText}>
<                   <Logotext />
<                   <div
<                     style={{
<                       height: 6,
<                       marginBottom: 30,
<                       background:
<                         "linear-gradient(90deg, rgba(255,214,69,1) 0%, rgba(255,214,69,1) 25%, rgba(101,206,191,1) 25%, rgba(101,206,191,1) 50%, rgba(255,119,91,1) 50%, rgba(255,119,91,1) 75%, rgba(134,182,255,1) 75%, rgba(134,182,255,1) 100%)",
<                     }}
<                   />
<                 </Box>
<                 {/* TODO remove in next commit  */}
<                 {/* <TextField
<                   select
<                   label={`${t("Select Language")}`}
<                   style={{ width: "100%" }}
<                   onChange={(event) => {
<                     setSelectedLanguage(event.target.value)
---
>         <Grid container spacing={2} justifyContent="center" alignItems="center">
>           <Grid item xs={12} md={6}>
>             <div style={{
>               display: "flex",
>               flexDirection: "column",
>               alignItems: "center",
>               justifyContent: "center"
>             }}>
>               <Box className={classes.logoLogin}>
>                 <Logo />
>               </Box>
>               <div className={classes.logoText}>
>                 <Logotext />
>                 <div
>                   style={{
>                     width: "100%",  // Changed from maxWidth to width
>                     maxWidth: 320,  // Keep this as a limit
>                     height: 6,
>                     marginBottom: 30,
>                     margin: "0 auto", // Added to help with centering
>                     background:
>                       "linear-gradient(90deg, rgba(255,214,69,1) 0%, rgba(255,214,69,1) 25%, rgba(101,206,191,1) 25%, rgba(101,206,191,1) 50%, rgba(255,119,91,1) 50%, rgba(255,119,91,1) 75%, rgba(134,182,255,1) 75%, rgba(134,182,255,1) 100%)",
1077,1078c599,618
<                   variant="filled"
<                   value={selectedLanguage || "en-US"}
---
>                 />
>               </div>
>             </div>
>           </Grid>
>           <Grid item xs={12} md={6} style={{
>             height: "100vh",          // From loginContainer
>             display: "flex",         // For vertical centering
>             alignItems: "center",    // For vertical centering
>             justifyContent: "center",
>             // paddingTop: "3%"         // From loginContainer
>           }} >
>             <div style={{ borderRadius: "10px", background: "#D4D4D4", padding: "30px", display: "flex", flexDirection: "column", position: "relative" }}>
>               <div style={{ position: "absolute", top: 8, right: 16, display: "flex", alignItems: "center", gap: "8px" }}>
>                 <Fab
>                   color="primary"
>                   aria-label="select language"
>                   // onClick={handleOpen}
>                   onClick={(event) => setFabMenu(event.currentTarget)} // Open menu on click
>                   size="small"
>                 // style={{ position: "fixed", top: 16, right: 16 }}
1080c620,627
<                   {Object.keys(locale_lang).map((key, value) => {
---
>                   <TranslateIcon />
>                 </Fab>
>                 <Menu
>                   anchorEl={fabMenu} // Position menu relative to Fab
>                   open={Boolean(fabMenu)} // Open the menu if fabMenu is set
>                   onClose={() => setFabMenu(null)} // Close menu on selection or outside click
>                 >
>                   {Object.keys(locale_lang).map((key) => {
1083,1084c630,638
<                         <MenuItem key={key} value={key}>
<                           {locale_lang[key].native + " (" + locale_lang[key].english + ")"}
---
>                         <MenuItem
>                           key={key}
>                           value={key}
>                           onClick={() => {
>                             setSelectedLanguage(key) // Set language on click
>                             setFabMenu(null) // Close menu
>                           }}
>                         >
>                           {`${locale_lang[key].native} (${locale_lang[key].english})`}
1089,1206c643,660
<                 </TextField> */}
<                 {/* <Autocomplete
<                   freeSolo={true}
<                   id="serever-selector"
<                   options={options}
<                   sx={{ width: "100%", marginTop: "12px" }}
<                   value={state.serverAddress || ""}
<                   // disabled
<                   onChange={(event, value) => handleServerInput(value)}
<                   renderInput={(params) => (
<                     <TextField
<                       {...params}
<                       name="serverAddress"
<                       variant="filled"
<                       value={state.serverAddress || ""}
<                       onChange={(event) => handleServerInput(event.target.value)}
<                       InputProps={{ ...params.InputProps, disableUnderline: true }}
<                       label={t("Server Address")}
<                       helperText={t("Don't enter a domain if you're not sure what this option does.")}
<                     />
<                   )}
<                 /> */}
<                 <TextField
<                   required
<                   name="id"
<                   type="email"
<                   margin="normal"
<                   variant="outlined"
<                   style={{ width: "100%", height: 50 }}
<                   placeholder={`${t("my.email@address.com")}`}
<                   value={state.id || ""}
<                   onChange={handleChange}
<                   InputLabelProps={{ shrink: true }}
<                   InputProps={{
<                     classes: {
<                       root: classes.textfieldStyle,
<                     },
<                     autoCapitalize: "off",
<                   }}
<                 />
< 
<                 <TextField
<                   required
<                   name="password"
<                   type="password"
<                   margin="normal"
<                   variant="outlined"
<                   style={{ width: "100%", height: 50, marginBottom: 40 }}
<                   placeholder="•••••••••"
<                   value={state.password || ""}
<                   onChange={handleChange}
<                   InputProps={{
<                     classes: {
<                       root: classes.textfieldStyle,
<                     },
<                   }}
<                 />
< 
<                 <Box className={classes.buttonNav} width={1} textAlign="center">
<                   <Fab
<                     variant="extended"
<                     type="submit"
<                     style={{ background: "#7599FF", color: "White" }}
<                     onClick={handleLogin}
<                     className={loginClick ? classes.loginDisabled : ""}
<                   >
<                     {`${t("Login")}`}
<                     <input
<                       type="submit"
<                       style={{
<                         cursor: "pointer",
<                         position: "absolute",
<                         top: 0,
<                         bottom: 0,
<                         right: 0,
<                         left: 0,
<                         width: "100%",
<                         opacity: 0,
<                       }}
<                       disabled={loginClick}
<                     />
<                   </Fab>
<                 </Box>
< 
<                 {/* google login here */}
<                 <GoogleOAuthProvider clientId={GOOGLE_CLIENT_ID}>
<                   <div className={classes.dividerContainer}>
<                     <Divider className={classes.divider} />
<                     <Typography variant="body2" className={classes.dividerText}>
<                       {t("or")}
<                     </Typography>
<                     <Divider className={classes.divider} />
<                   </div>
< 
<                   <div className={classes.googleButton}>
<                     <GoogleLogin
<                       onSuccess={handleGoogleSuccess}
<                       onError={handleGoogleError}
<                       shape="rectangular"
<                       theme="filled_blue"
<                       text="continue_with"
<                       locale={selectedLanguage}
<                     />
<                   </div>
<                 </GoogleOAuthProvider>
< 
<                 <div className={classes.dividerContainer}>
<                   <Divider className={classes.divider} />
<                   <Typography variant="body2" className={classes.dividerText}>
<                     {t("or")}
<                   </Typography>
<                   <Divider className={classes.divider} />
<                 </div>
< 
<                 <button
<                   className={classes.miniOrangeButton}
<                   onClick={handleMiniOrangeLogin}
<                   disabled={miniOrangeLoading || loginClick}
---
>                 </Menu>
>                 <Fab
>                   size="small"
>                   color="primary"
>                   aria-label="help"
>                   // style={{ position: "fixed", top: 8, right: 8 }}
>                   onClick={(event) => setHelpMenu(event.currentTarget)}
>                 >
>                   {/* <HelpCenterOutlined/> */}
>                   <HelpIcon style={{ fontSize: "2.5 rem" }} />
>                   {/* <Icon style={{ fontSize: "2rem", color:"#23c433" }}>help</Icon> */}
>                 </Fab>
>                 <Menu
>                   id="simple-menu"
>                   anchorEl={helpMenu}
>                   keepMounted
>                   open={Boolean(helpMenu)}
>                   onClose={() => setHelpMenu(undefined)}
1208,1219c662,667
<                   {miniOrangeLoading ? (
<                           <CircularProgress size={24} color="inherit" />
<                         ) : (
<                           t("Sign in with MiniOrange")
<                         )}
<                 </button>
< 
<                 <Box textAlign="center" width={1} mt={4} mb={4}>
<                   <Link
<                     underline="none"
<                     className={classes.linkBlue}
<                     onClick={(event) => setTryitMenu(event.currentTarget)}
---
>                   <MenuItem
>                     dense
>                     onClick={() => {
>                       setHelpMenu(undefined)
>                       window.open("https://docs.lamp.digital", "_blank")
>                     }}
1221,1227c669,676
<                     {`${t("Try it")}`}
<                   </Link>
<                   <br />
<                   <Link
<                     underline="none"
<                     className={classes.linkBlue}
<                     onClick={(event) => window.open("https://www.digitalpsych.org/studies.html", "_blank")}
---
>                     <b style={{ color: colors.grey["600"] }}>{`${t("Help & Support")}`}</b>
>                   </MenuItem>
>                   <MenuItem
>                     dense
>                     onClick={() => {
>                       setHelpMenu(undefined)
>                       window.open("https://community.lamp.digital", "_blank")
>                     }}
1229,1236c678,685
<                     {`${t("Research studies using mindLAMP")}`}
<                   </Link>
<                   <Menu
<                     keepMounted
<                     open={Boolean(tryitMenu)}
<                     anchorPosition={tryitMenu?.getBoundingClientRect()}
<                     anchorReference="anchorPosition"
<                     onClose={() => setTryitMenu(undefined)}
---
>                     <b style={{ color: colors.grey["600"] }}>LAMP {`${t("Community")}`}</b>
>                   </MenuItem>
>                   <MenuItem
>                     dense
>                     onClick={() => {
>                       setHelpMenu(undefined)
>                       window.open("mailto:team@digitalpsych.org", "_blank")
>                     }}
1238,1277c687,903
<                     <MenuItem disabled divider>
<                       <b>{`${t("Try mindLAMP out as a...")}`}</b>
<                     </MenuItem>
<                     <MenuItem
<                       onClick={(event) => {
<                         setTryitMenu(undefined)
<                         handleLogin(event, "researcher")
<                       }}
<                     >
<                       {`${t("Researcher")}`}
<                     </MenuItem>
<                     <MenuItem
<                       divider
<                       onClick={(event) => {
<                         setTryitMenu(undefined)
<                         handleLogin(event, "clinician")
<                       }}
<                     >
<                       {`${t("Clinician")}`}
<                     </MenuItem>
<                     <MenuItem
<                       onClick={(event) => {
<                         setTryitMenu(undefined)
<                         handleLogin(event, "participant")
<                       }}
<                     >
<                       {`${t("Participant")}`}
<                     </MenuItem>
<                     <MenuItem
<                       onClick={(event) => {
<                         setTryitMenu(undefined)
<                         handleLogin(event, "patient")
<                       }}
<                     >
<                       {`${t("User")}`}
<                     </MenuItem>
<                   </Menu>
<                 </Box>
<               </Box>
<             </form>
---
>                     <b style={{ color: colors.grey["600"] }}>{`${t("Contact Us")}`}</b>
>                   </MenuItem>
>                   <MenuItem
>                     dense
>                     onClick={() => {
>                       setHelpMenu(undefined)
>                       window.open("https://docs.lamp.digital/privacy/", "_blank")
>                     }}
>                   >
>                     <b style={{ color: colors.grey["600"] }}>{`${t("Privacy Policy")}`}</b>
>                   </MenuItem>
>                 </Menu>
>               </div>
> 
>               {showForgotPassword ? (
>                 <>
>                   <ForgotPasswordForm
>                     onBack={() => setShowForgotPassword(false)}
>                     classes={classes}
>                   />
>                 </>
>               ) : (
>                 <>
>                   <h1 style={{
>                     marginTop: "20px",
>                     alignSelf: "center"  // This centers only the h1
>                   }}>
>                     Sign In
>                   </h1>
>                   <form
>                     onSubmit={(e) => handleLogin(e)}
>                     style={{
>                       // width: "100%",
>                       // maxWidth: "100%",         // From loginInner
>                       // margin: "0 auto"       // For horizontal centering
>                     }}
>                   >
>                     <Box>
>                       <TextField
>                         required
>                         name="id"
>                         type="email"
>                         margin="normal"
>                         variant="outlined"
>                         style={{ width: "100%", height: 50 }}
>                         placeholder={`${t("my.email@address.com")}`}
>                         value={state.id || ""}
>                         onChange={handleChange}
>                         InputLabelProps={{ shrink: true }}
>                         InputProps={{
>                           classes: {
>                             root: classes.textfieldStyle,
>                           },
>                           autoCapitalize: "off",
>                         }}
>                       />
> 
>                       <TextField
>                         required
>                         name="password"
>                         type="password"
>                         margin="normal"
>                         variant="outlined"
>                         style={{ width: "100%", height: 50, marginBottom: 40 }}
>                         placeholder="•••••••••"
>                         value={state.password || ""}
>                         onChange={handleChange}
>                         InputProps={{
>                           classes: {
>                             root: classes.textfieldStyle,
>                           },
>                         }}
>                       />
> 
>                       <h4
>                         style={{
>                           padding: "0px",
>                           margin: "0px auto 20px",
>                           color: "red",
>                           alignSelf: "center",
>                           textAlign: "center",
>                           cursor: "pointer"  // Add this to show it's clickable
>                         }}
>                         onClick={() => setShowForgotPassword(true)}
>                       >
>                         Forgot Password?
>                       </h4>
> 
>                       <Box className={classes.buttonNav} width={1} textAlign="center">
>                         <Fab
>                           variant="extended"
>                           type="submit"
>                           style={{ background: "#7599FF", color: "White" }}
>                           onClick={handleLogin}
>                           className={loginClick ? classes.loginDisabled : ""}
>                         >
>                           {`${t("Login")}`}
>                           <input
>                             type="submit"
>                             style={{
>                               cursor: "pointer",
>                               position: "absolute",
>                               top: 0,
>                               bottom: 0,
>                               right: 0,
>                               left: 0,
>                               width: "100%",
>                               opacity: 0,
>                             }}
>                             disabled={loginClick}
>                           />
>                         </Fab>
>                       </Box>
> 
>                       {/* google login here */}
>                       <GoogleOAuthProvider clientId={GOOGLE_CLIENT_ID}>
>                         <div className={classes.dividerContainer}>
>                           <Divider className={classes.divider} />
>                           <Typography variant="body2" className={classes.dividerText}>
>                             {t("or")}
>                           </Typography>
>                           <Divider className={classes.divider} />
>                         </div>
> 
>                         <div className={classes.googleButton}>
>                           <GoogleLogin
>                             onSuccess={handleGoogleSuccess}
>                             onError={handleGoogleError}
>                             shape="rectangular"
>                             theme="filled_blue"
>                             text="continue_with"
>                             locale={selectedLanguage}
>                           />
>                         </div>
>                       </GoogleOAuthProvider>
> 
>                       <div className={classes.dividerContainer}>
>                         <Divider className={classes.divider} />
>                         <Typography variant="body2" className={classes.dividerText}>
>                           {t("or")}
>                         </Typography>
>                         <Divider className={classes.divider} />
>                       </div>
> 
>                       <button
>                         className={classes.miniOrangeButton}
>                         onClick={handleMiniOrangeLogin}
>                         disabled={miniOrangeLoading}
>                       >
>                         {miniOrangeLoading ? t("Loading...") : t("Continue with MiniOrange")}
>                       </button>
> 
>                       <Box textAlign="center" width={1} mt={4} mb={4}>
>                         <Link
>                           underline="none"
>                           className={classes.linkBlue}
>                           onClick={(event) => setTryitMenu(event.currentTarget)}
>                         >
>                           {`${t("Try it")}`}
>                         </Link>
>                         <br />
>                         <Link
>                           underline="none"
>                           className={classes.linkBlue}
>                           onClick={(event) => window.open("https://www.digitalpsych.org/studies.html", "_blank")}
>                         >
>                           {`${t("Research studies using mindLAMP")}`}
>                         </Link>
>                         <Menu
>                           keepMounted
>                           open={Boolean(tryitMenu)}
>                           anchorPosition={tryitMenu?.getBoundingClientRect()}
>                           anchorReference="anchorPosition"
>                           onClose={() => setTryitMenu(undefined)}
>                         >
>                           <MenuItem disabled divider>
>                             <b>{`${t("Try mindLAMP out as a...")}`}</b>
>                           </MenuItem>
>                           <MenuItem
>                             onClick={(event) => {
>                               setTryitMenu(undefined)
>                               handleLogin(event, "researcher")
>                             }}
>                           >
>                             {`${t("Researcher")}`}
>                           </MenuItem>
>                           <MenuItem
>                             divider
>                             onClick={(event) => {
>                               setTryitMenu(undefined)
>                               handleLogin(event, "clinician")
>                             }}
>                           >
>                             {`${t("Clinician")}`}
>                           </MenuItem>
>                           <MenuItem
>                             onClick={(event) => {
>                               setTryitMenu(undefined)
>                               handleLogin(event, "participant")
>                             }}
>                           >
>                             {`${t("Participant")}`}
>                           </MenuItem>
>                           <MenuItem
>                             onClick={(event) => {
>                               setTryitMenu(undefined)
>                               handleLogin(event, "patient")
>                             }}
>                           >
>                             {`${t("User")}`}
>                           </MenuItem>
>                         </Menu>
>                       </Box>
>                     </Box>
>                   </form>
>                 </>)}
>             </div>
